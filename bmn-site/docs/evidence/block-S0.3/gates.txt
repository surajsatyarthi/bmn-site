
> bmn-site@0.1.0 ralph:gates
> bash scripts/validate-ralph-gates.sh S0.3

ðŸ¦… Ralph Protocol v6.0: Gate Validation [Block S0.3]
========================================================
G1: Physical Audit... âœ… PASS
G2: Task Spec Review... âœ… PASS
G3: Implementation Plan... âœ… PASS
G4: Build... 
> bmn-site@0.1.0 build
> next build

âš  Warning: Next.js inferred your workspace root, but it may not be correct.
 We detected multiple lockfiles and selected the directory of /Users/surajsatyarthi/Projects/active/BMN/pnpm-lock.yaml as the root directory.
 To silence this warning, set `turbopack.root` in your Next.js config, or consider removing one of the lockfiles if it's not needed.
   See https://nextjs.org/docs/app/api-reference/config/next-config-js/turbopack#root-directory for more information.
 Detected additional lockfiles: 
   * /Users/surajsatyarthi/Projects/active/BMN/bmn-site/pnpm-lock.yaml

â–² Next.js 16.1.6 (Turbopack)
- Environments: .env.local
- Experiments (use with caution):
  Â· clientTraceMetadata

âš  The "middleware" file convention is deprecated. Please use "proxy" instead. Learn more: https://nextjs.org/docs/messages/middleware-to-proxy
  Creating an optimized production build ...
âœ“ Compiled successfully in 3.9s
  Running next.config.js provided runAfterProductionCompile ...
âœ“ Completed runAfterProductionCompile in 311ms
  Running TypeScript ...
  Collecting page data using 9 workers ...
  Generating static pages using 9 workers (0/28) ...
  Generating static pages using 9 workers (7/28) 
  Generating static pages using 9 workers (14/28) 
  Generating static pages using 9 workers (21/28) 
âœ“ Generating static pages using 9 workers (28/28) in 177.3ms
  Finalizing page optimization ...

Route (app)
â”Œ â—‹ /
â”œ â—‹ /_not-found
â”œ Æ’ /admin
â”œ Æ’ /admin/campaigns
â”œ Æ’ /admin/matches/upload
â”œ Æ’ /admin/users
â”œ Æ’ /admin/users/[id]
â”œ Æ’ /api/admin/matches
â”œ Æ’ /api/admin/users
â”œ Æ’ /api/admin/users/[id]
â”œ Æ’ /api/campaigns
â”œ Æ’ /api/campaigns/[id]
â”œ Æ’ /api/health
â”œ Æ’ /api/matches
â”œ Æ’ /api/matches/[id]
â”œ Æ’ /api/matches/[id]/reveal
â”œ Æ’ /api/profile
â”œ Æ’ /api/profile/onboarding
â”œ Æ’ /campaigns
â”œ Æ’ /campaigns/[id]
â”œ â—‹ /contact
â”œ Æ’ /dashboard
â”œ â—‹ /forgot-password
â”œ â—‹ /icon.png
â”œ â—‹ /login
â”œ Æ’ /matches
â”œ Æ’ /matches/[id]
â”œ Æ’ /onboarding
â”œ â—‹ /privacy
â”œ Æ’ /profile
â”œ â—‹ /refund
â”œ â—‹ /signup
â”œ â—‹ /terms
â”” â—‹ /verify-email


Æ’ Proxy (Middleware)

â—‹  (Static)   prerendered as static content
Æ’  (Dynamic)  server-rendered on demand

âœ… PASS
G5: Lint... 
> bmn-site@0.1.0 lint
> eslint

âœ… PASS
G6: Security Scan... 
ðŸ¦… Ralph Protocol v5.1: Security Scanner [FULL]


ðŸ“‹ CODE CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸ”´ SEC-001: Payment Replay Attack Vulnerability... âœ…
ðŸ”´ SEC-002: Production Mock Data Fallback... âœ…
ðŸ”´ SEC-003: Environment Variable Validation... âœ…
ðŸ”´ SEC-004: No Secrets in Source Code... âœ…
ðŸŸ¡ SEC-005: Rate Limiting on POST Routes... âœ…
ðŸŸ¡ QA-001: Error Boundary Existence... âœ…
ðŸŸ¡ QA-002: Loading State Existence... âœ…
ðŸŸ¡ QA-003: Interactive Elements Accessibility... âœ…
ðŸ”´ QA-004: Metadata Export... âœ…

ðŸ“‹ DEPENDENCY CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸ”´ DEP-001: Required Dependencies Installed... âœ…

ðŸ“‹ BUILD CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸ”´ BLD-001: TypeScript compilation succeeds... âœ…
ðŸ”´ BLD-002: Next.js build succeeds... âœ…
ðŸŸ¡ BLD-003: ESLint passes (src/)... âœ…

ðŸ“‹ DEPLOYMENT CHECKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ðŸŸ¡ DPL-001: Env vars documented in .env.example... âœ…
ðŸŸ¡ DPL-002: Git is clean...    Uncommitted changes:
      M .husky/pre-commit
      M .husky/pre-push
      M bmn-site/docs/evidence/block-S0.3/gates.txt
      D bmn-site/scripts/fix-lint-any.ts
      M bmn-site/scripts/ralph-security-scanner.ts
      M bmn-site/scripts/validate-ralph-gates.sh
      M bmn-site/src/app/(admin)/admin/matches/upload/page.tsx
      M bmn-site/src/app/(auth)/forgot-password/page.tsx
      M bmn-site/src/app/(auth)/login/page.tsx
      M bmn-site/src/app/(auth)/signup/page.tsx
      M bmn-site/src/app/(auth)/verify-email/page.tsx
      M docs/governance/project_ledger.md
      D docs/governance/project_ledger.md.bak
     ?? docs/governance/project_ledger.tmp
âŒ
   Severity: P1
   Description: All changes must be committed before deploy.
   Fix: Commit all changes before deploying.

==================================================
Security Scan Complete: 14/15 Passed
==================================================

âš ï¸  P1 warnings (fix before launch)

âœ… PASS
G7: Tests... 
> bmn-site@0.1.0 test
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/Users/surajsatyarthi/Projects/active/BMN/bmn-site[39m

 [32mâœ“[39m tests/lib/rate-limit.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 4[2mms[22m[39m
[90mstderr[2m | tests/lib/api-error.test.ts[2m > [22m[2mhandleApiError[2m > [22m[2mshould handle unknown errors as 500
[22m[39mUnhandled error: Error: Something went wrong
    at [90m/Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mtests/lib/api-error.test.ts:34:19
    at [90mfile:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.18_@opentelemetry+api@1.9.0_@types+node@20.19.33_jiti@2.6.1_jsdom@28.0.0_lig_9afb8edde56f362813de97e8789ff31a/node_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/vitest@4.0.18_@opentelemetry+api@1.9.0_@types+node@20.19.33_jiti@2.6.1_jsdom@28.0.0_lig_9afb8edde56f362813de97e8789ff31a/node_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/surajsatyarthi/Projects/active/BMN/bmn-site/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.18/node_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

 [32mâœ“[39m tests/lib/api-error.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m tests/lib/env.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 32[2mms[22m[39m
 [32mâœ“[39m tests/onboarding/HSCodeSearch.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 30[2mms[22m[39m

[2m Test Files [22m [1m[32m4 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[32m13 passed[39m[22m[90m (13)[39m
[2m   Start at [22m 00:46:02
[2m   Duration [22m 655ms[2m (transform 127ms, setup 173ms, import 190ms, tests 71ms, environment 1.44s)[22m

âœ… PASS
G8: Pre-submission Gate... âœ… PASS
G9: Self-Audit... âœ… PASS
G10: Visual Verification... âœ… PASS (Skipped for Script-Only Block S0.3)
========================================================
ðŸŽ‰ ALL GATES PASSED for Block S0.3
